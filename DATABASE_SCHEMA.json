{
  "database_name": "dealharbor_backend",
  "database_type": "PostgreSQL",
  "description": "Intra-university e-commerce platform for student-to-student marketplace",
  
  "tables": {
    
    "users": {
      "table_name": "users",
      "description": "Core user table storing student profiles with authentication and performance metrics",
      "columns": {
        "id": {
          "type": "UUID",
          "nullable": false,
          "primary_key": true,
          "description": "Unique user identifier"
        },
        "email": {
          "type": "VARCHAR",
          "nullable": false,
          "unique": true,
          "description": "User's primary email address"
        },
        "password_hash": {
          "type": "VARCHAR",
          "nullable": false,
          "description": "Encrypted password hash"
        },
        "name": {
          "type": "VARCHAR",
          "nullable": false,
          "description": "User's full name"
        },
        "role": {
          "type": "ENUM",
          "nullable": false,
          "enum_values": ["USER", "ADMIN"],
          "description": "User role in the system"
        },
        "enabled": {
          "type": "BOOLEAN",
          "nullable": false,
          "description": "Account activation status"
        },
        "locked": {
          "type": "BOOLEAN",
          "nullable": false,
          "description": "Account lock status"
        },
        "profile_photo_url": {
          "type": "VARCHAR(500)",
          "nullable": true,
          "description": "URL to user's profile photo"
        },
        "bio": {
          "type": "VARCHAR(500)",
          "nullable": true,
          "description": "User's biography"
        },
        "phone_number": {
          "type": "VARCHAR(20)",
          "nullable": true,
          "description": "User's phone number"
        },
        "university_email": {
          "type": "VARCHAR(255)",
          "nullable": true,
          "unique": true,
          "description": "VIT student email address"
        },
        "university_id": {
          "type": "VARCHAR(100)",
          "nullable": true,
          "description": "Student/Staff ID number"
        },
        "graduation_year": {
          "type": "INTEGER",
          "nullable": true,
          "description": "Expected graduation year"
        },
        "department": {
          "type": "VARCHAR(100)",
          "nullable": true,
          "description": "Academic department"
        },
        "is_verified_student": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": false,
          "description": "Student verification status"
        },
        "google_id": {
          "type": "VARCHAR(100)",
          "nullable": true,
          "description": "Google OAuth ID"
        },
        "github_id": {
          "type": "VARCHAR(100)",
          "nullable": true,
          "description": "GitHub OAuth ID"
        },
        "provider": {
          "type": "VARCHAR(20)",
          "nullable": false,
          "default": "LOCAL",
          "description": "Authentication provider"
        },
        "seller_rating": {
          "type": "DECIMAL(3,2)",
          "nullable": true,
          "default": 0.00,
          "description": "Average seller rating (1.0-5.0)"
        },
        "buyer_rating": {
          "type": "DECIMAL(3,2)",
          "nullable": true,
          "default": 0.00,
          "description": "Average buyer rating (1.0-5.0)"
        },
        "total_sales": {
          "type": "INTEGER",
          "nullable": false,
          "default": 0,
          "description": "Total number of successful sales"
        },
        "total_purchases": {
          "type": "INTEGER",
          "nullable": false,
          "default": 0,
          "description": "Total number of purchases made"
        },
        "total_listings": {
          "type": "INTEGER",
          "nullable": false,
          "default": 0,
          "description": "Total products ever listed"
        },
        "active_listings": {
          "type": "INTEGER",
          "nullable": false,
          "default": 0,
          "description": "Currently active product listings"
        },
        "seller_badge": {
          "type": "ENUM",
          "nullable": true,
          "enum_values": ["NEW_SELLER", "ACTIVE_SELLER", "TRUSTED_SELLER", "DEALHARBOR_CHOICE", "PREMIUM_SELLER", "LEGENDARY_SELLER"],
          "default": "NEW_SELLER",
          "description": "Seller performance badge"
        },
        "first_sale_at": {
          "type": "TIMESTAMP",
          "nullable": true,
          "description": "Date of first successful sale"
        },
        "total_revenue": {
          "type": "DECIMAL(10,2)",
          "nullable": true,
          "default": 0.00,
          "description": "Total revenue generated from sales"
        },
        "response_rate": {
          "type": "DECIMAL(5,2)",
          "nullable": true,
          "default": 0.00,
          "description": "Message response rate percentage"
        },
        "positive_reviews": {
          "type": "INTEGER",
          "nullable": false,
          "default": 0,
          "description": "Number of positive reviews received"
        },
        "negative_reviews": {
          "type": "INTEGER",
          "nullable": false,
          "default": 0,
          "description": "Number of negative reviews received"
        },
        "is_banned": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": false,
          "description": "Account ban status"
        },
        "banned_until": {
          "type": "TIMESTAMP",
          "nullable": true,
          "description": "Ban expiration date"
        },
        "ban_reason": {
          "type": "VARCHAR(500)",
          "nullable": true,
          "description": "Reason for account ban"
        },
        "failed_login_attempts": {
          "type": "INTEGER",
          "nullable": false,
          "default": 0,
          "description": "Failed login attempt counter"
        },
        "locked_until": {
          "type": "TIMESTAMP",
          "nullable": true,
          "description": "Account lock expiration"
        },
        "last_login_at": {
          "type": "TIMESTAMP",
          "nullable": true,
          "description": "Last successful login timestamp"
        },
        "last_login_ip": {
          "type": "VARCHAR(45)",
          "nullable": true,
          "description": "IP address of last login"
        },
        "email_verified": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": false,
          "description": "Email verification status"
        },
        "two_factor_enabled": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": false,
          "description": "Two-factor authentication status"
        },
        "created_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Account creation timestamp"
        },
        "updated_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Last profile update timestamp"
        },
        "deleted": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": false,
          "description": "Soft delete flag"
        },
        "deleted_at": {
          "type": "TIMESTAMP",
          "nullable": true,
          "description": "Account deletion timestamp"
        }
      },
      "indexes": [
        "email",
        "university_email",
        "seller_rating",
        "created_at"
      ]
    },

    "categories": {
      "table_name": "categories",
      "description": "Product categorization system with hierarchical structure",
      "columns": {
        "id": {
          "type": "UUID",
          "nullable": false,
          "primary_key": true,
          "description": "Unique category identifier"
        },
        "name": {
          "type": "VARCHAR(100)",
          "nullable": false,
          "unique": true,
          "description": "Category name"
        },
        "description": {
          "type": "TEXT",
          "nullable": true,
          "description": "Category description"
        },
        "parent_id": {
          "type": "VARCHAR",
          "nullable": true,
          "description": "Parent category ID for hierarchical structure"
        },
        "icon_url": {
          "type": "VARCHAR(500)",
          "nullable": true,
          "description": "Category icon URL"
        },
        "is_active": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": true,
          "description": "Category visibility status"
        },
        "sort_order": {
          "type": "INTEGER",
          "nullable": false,
          "default": 0,
          "description": "Display order priority"
        },
        "created_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Category creation timestamp"
        },
        "updated_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Last update timestamp"
        }
      },
      "relationships": [
        {
          "type": "one_to_many",
          "target": "products",
          "description": "Category can have multiple products"
        }
      ]
    },

    "products": {
      "table_name": "products",
      "description": "Product listings with detailed information and status tracking",
      "columns": {
        "id": {
          "type": "UUID",
          "nullable": false,
          "primary_key": true,
          "description": "Unique product identifier"
        },
        "title": {
          "type": "VARCHAR(200)",
          "nullable": false,
          "description": "Product title"
        },
        "description": {
          "type": "TEXT",
          "nullable": false,
          "description": "Detailed product description"
        },
        "price": {
          "type": "DECIMAL(10,2)",
          "nullable": false,
          "description": "Current selling price"
        },
        "original_price": {
          "type": "DECIMAL(10,2)",
          "nullable": true,
          "description": "Original retail price"
        },
        "is_negotiable": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": false,
          "description": "Price negotiation allowed"
        },
        "condition": {
          "type": "ENUM",
          "nullable": false,
          "enum_values": ["NEW", "LIKE_NEW", "GOOD", "FAIR", "POOR", "USED"],
          "default": "USED",
          "description": "Product condition"
        },
        "brand": {
          "type": "VARCHAR(100)",
          "nullable": true,
          "description": "Product brand"
        },
        "model": {
          "type": "VARCHAR(100)",
          "nullable": true,
          "description": "Product model"
        },
        "category_id": {
          "type": "UUID",
          "nullable": false,
          "foreign_key": "categories.id",
          "description": "Product category reference"
        },
        "seller_id": {
          "type": "UUID",
          "nullable": false,
          "foreign_key": "users.id",
          "description": "Seller reference"
        },
        "approved_by": {
          "type": "UUID",
          "nullable": true,
          "foreign_key": "users.id",
          "description": "Admin who approved the product"
        },
        "tags": {
          "type": "TEXT",
          "nullable": true,
          "description": "JSON array of search tags"
        },
        "status": {
          "type": "ENUM",
          "nullable": false,
          "enum_values": ["PENDING", "APPROVED", "REJECTED", "SOLD", "DELETED"],
          "default": "PENDING",
          "description": "Product approval status"
        },
        "admin_notes": {
          "type": "TEXT",
          "nullable": true,
          "description": "Admin review notes"
        },
        "approved_at": {
          "type": "TIMESTAMP",
          "nullable": true,
          "description": "Approval timestamp"
        },
        "view_count": {
          "type": "INTEGER",
          "nullable": false,
          "default": 0,
          "description": "Number of product views"
        },
        "favorite_count": {
          "type": "INTEGER",
          "nullable": false,
          "default": 0,
          "description": "Number of users who favorited"
        },
        "is_featured": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": false,
          "description": "Featured product status"
        },
        "pickup_location": {
          "type": "VARCHAR(200)",
          "nullable": true,
          "description": "Pickup location details"
        },
        "delivery_available": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": false,
          "description": "Delivery service availability"
        },
        "created_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Product listing timestamp"
        },
        "updated_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Last update timestamp"
        },
        "sold_at": {
          "type": "TIMESTAMP",
          "nullable": true,
          "description": "Sale completion timestamp"
        }
      },
      "relationships": [
        {
          "type": "many_to_one",
          "target": "users",
          "foreign_key": "seller_id",
          "description": "Product belongs to a seller"
        },
        {
          "type": "many_to_one",
          "target": "categories",
          "foreign_key": "category_id",
          "description": "Product belongs to a category"
        },
        {
          "type": "one_to_many",
          "target": "product_images",
          "description": "Product can have multiple images"
        }
      ]
    },

    "product_images": {
      "table_name": "product_images",
      "description": "Product image management with metadata",
      "columns": {
        "id": {
          "type": "UUID",
          "nullable": false,
          "primary_key": true,
          "description": "Unique image identifier"
        },
        "product_id": {
          "type": "UUID",
          "nullable": false,
          "foreign_key": "products.id",
          "description": "Associated product reference"
        },
        "image_url": {
          "type": "VARCHAR(500)",
          "nullable": false,
          "description": "Image file URL"
        },
        "alt_text": {
          "type": "VARCHAR(200)",
          "nullable": true,
          "description": "Alternative text for accessibility"
        },
        "is_primary": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": false,
          "description": "Primary image flag"
        },
        "sort_order": {
          "type": "INTEGER",
          "nullable": false,
          "default": 0,
          "description": "Image display order"
        },
        "file_size": {
          "type": "INTEGER",
          "nullable": true,
          "description": "File size in bytes"
        },
        "width": {
          "type": "INTEGER",
          "nullable": true,
          "description": "Image width in pixels"
        },
        "height": {
          "type": "INTEGER",
          "nullable": true,
          "description": "Image height in pixels"
        },
        "created_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Image upload timestamp"
        }
      },
      "relationships": [
        {
          "type": "many_to_one",
          "target": "products",
          "foreign_key": "product_id",
          "description": "Image belongs to a product"
        }
      ]
    },

    "orders": {
      "table_name": "orders",
      "description": "Transaction records between buyers and sellers",
      "columns": {
        "id": {
          "type": "UUID",
          "nullable": false,
          "primary_key": true,
          "description": "Unique order identifier"
        },
        "order_number": {
          "type": "VARCHAR(20)",
          "nullable": false,
          "unique": true,
          "description": "Human-readable order number"
        },
        "buyer_id": {
          "type": "UUID",
          "nullable": false,
          "foreign_key": "users.id",
          "description": "Buyer reference"
        },
        "seller_id": {
          "type": "UUID",
          "nullable": false,
          "foreign_key": "users.id",
          "description": "Seller reference"
        },
        "product_id": {
          "type": "UUID",
          "nullable": false,
          "foreign_key": "products.id",
          "description": "Ordered product reference"
        },
        "product_title": {
          "type": "VARCHAR(200)",
          "nullable": false,
          "description": "Product title snapshot"
        },
        "agreed_price": {
          "type": "DECIMAL(10,2)",
          "nullable": false,
          "description": "Final negotiated price"
        },
        "original_price": {
          "type": "DECIMAL(10,2)",
          "nullable": false,
          "description": "Original listing price"
        },
        "status": {
          "type": "ENUM",
          "nullable": false,
          "enum_values": ["PENDING", "CONFIRMED", "COMPLETED", "CANCELLED", "DISPUTED"],
          "default": "PENDING",
          "description": "Order processing status"
        },
        "buyer_notes": {
          "type": "TEXT",
          "nullable": true,
          "description": "Buyer's notes or requests"
        },
        "seller_notes": {
          "type": "TEXT",
          "nullable": true,
          "description": "Seller's notes or instructions"
        },
        "pickup_location": {
          "type": "VARCHAR(200)",
          "nullable": true,
          "description": "Agreed pickup location"
        },
        "delivery_method": {
          "type": "ENUM",
          "nullable": true,
          "enum_values": ["PICKUP", "DELIVERY", "SHIPPING"],
          "default": "PICKUP",
          "description": "Delivery method selection"
        },
        "created_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Order creation timestamp"
        },
        "confirmed_at": {
          "type": "TIMESTAMP",
          "nullable": true,
          "description": "Seller confirmation timestamp"
        },
        "completed_at": {
          "type": "TIMESTAMP",
          "nullable": true,
          "description": "Order completion timestamp"
        },
        "cancelled_at": {
          "type": "TIMESTAMP",
          "nullable": true,
          "description": "Cancellation timestamp"
        }
      },
      "relationships": [
        {
          "type": "many_to_one",
          "target": "users",
          "foreign_key": "buyer_id",
          "description": "Order placed by buyer"
        },
        {
          "type": "many_to_one",
          "target": "users",
          "foreign_key": "seller_id",
          "description": "Order fulfilled by seller"
        },
        {
          "type": "many_to_one",
          "target": "products",
          "foreign_key": "product_id",
          "description": "Order for specific product"
        }
      ]
    },

    "favorites": {
      "table_name": "favorites",
      "description": "User's favorite products tracking",
      "columns": {
        "id": {
          "type": "UUID",
          "nullable": false,
          "primary_key": true,
          "description": "Unique favorite identifier"
        },
        "user_id": {
          "type": "UUID",
          "nullable": false,
          "foreign_key": "users.id",
          "description": "User who favorited"
        },
        "product_id": {
          "type": "UUID",
          "nullable": false,
          "foreign_key": "products.id",
          "description": "Favorited product"
        },
        "created_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "When product was favorited"
        }
      },
      "constraints": [
        {
          "type": "unique",
          "columns": ["user_id", "product_id"],
          "description": "One favorite per user per product"
        }
      ],
      "relationships": [
        {
          "type": "many_to_one",
          "target": "users",
          "foreign_key": "user_id",
          "description": "Favorite belongs to user"
        },
        {
          "type": "many_to_one",
          "target": "products",
          "foreign_key": "product_id",
          "description": "Favorite references product"
        }
      ]
    },

    "conversations": {
      "table_name": "conversations",
      "description": "Chat conversations between users",
      "columns": {
        "id": {
          "type": "UUID",
          "nullable": false,
          "primary_key": true,
          "description": "Unique conversation identifier"
        },
        "user1_id": {
          "type": "UUID",
          "nullable": false,
          "foreign_key": "users.id",
          "description": "First participant"
        },
        "user2_id": {
          "type": "UUID",
          "nullable": false,
          "foreign_key": "users.id",
          "description": "Second participant"
        },
        "product_id": {
          "type": "UUID",
          "nullable": true,
          "foreign_key": "products.id",
          "description": "Optional product context"
        },
        "order_id": {
          "type": "UUID",
          "nullable": true,
          "foreign_key": "orders.id",
          "description": "Optional order context"
        },
        "created_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Conversation start timestamp"
        },
        "last_message_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Last message timestamp"
        },
        "is_active": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": true,
          "description": "Conversation active status"
        }
      },
      "relationships": [
        {
          "type": "many_to_one",
          "target": "users",
          "foreign_key": "user1_id",
          "description": "First conversation participant"
        },
        {
          "type": "many_to_one",
          "target": "users",
          "foreign_key": "user2_id",
          "description": "Second conversation participant"
        },
        {
          "type": "one_to_many",
          "target": "messages",
          "description": "Conversation contains messages"
        }
      ]
    },

    "messages": {
      "table_name": "messages",
      "description": "Individual messages within conversations",
      "columns": {
        "id": {
          "type": "UUID",
          "nullable": false,
          "primary_key": true,
          "description": "Unique message identifier"
        },
        "conversation_id": {
          "type": "UUID",
          "nullable": false,
          "foreign_key": "conversations.id",
          "description": "Parent conversation"
        },
        "sender_id": {
          "type": "UUID",
          "nullable": false,
          "foreign_key": "users.id",
          "description": "Message sender"
        },
        "content": {
          "type": "TEXT",
          "nullable": false,
          "description": "Message content"
        },
        "message_type": {
          "type": "ENUM",
          "nullable": false,
          "enum_values": ["TEXT", "IMAGE", "FILE", "SYSTEM", "ORDER_UPDATE"],
          "default": "TEXT",
          "description": "Type of message content"
        },
        "attachment_url": {
          "type": "VARCHAR(500)",
          "nullable": true,
          "description": "URL for image/file attachments"
        },
        "is_read": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": false,
          "description": "Message read status"
        },
        "is_edited": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": false,
          "description": "Message edit status"
        },
        "is_deleted": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": false,
          "description": "Message deletion status"
        },
        "created_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Message sent timestamp"
        },
        "read_at": {
          "type": "TIMESTAMP",
          "nullable": true,
          "description": "Message read timestamp"
        },
        "edited_at": {
          "type": "TIMESTAMP",
          "nullable": true,
          "description": "Last edit timestamp"
        }
      },
      "relationships": [
        {
          "type": "many_to_one",
          "target": "conversations",
          "foreign_key": "conversation_id",
          "description": "Message belongs to conversation"
        },
        {
          "type": "many_to_one",
          "target": "users",
          "foreign_key": "sender_id",
          "description": "Message sent by user"
        }
      ]
    },

    "notifications": {
      "table_name": "notifications",
      "description": "System notifications for users",
      "columns": {
        "id": {
          "type": "UUID",
          "nullable": false,
          "primary_key": true,
          "description": "Unique notification identifier"
        },
        "user_id": {
          "type": "UUID",
          "nullable": false,
          "foreign_key": "users.id",
          "description": "Notification recipient"
        },
        "title": {
          "type": "VARCHAR(200)",
          "nullable": false,
          "description": "Notification title"
        },
        "message": {
          "type": "TEXT",
          "nullable": false,
          "description": "Notification content"
        },
        "type": {
          "type": "ENUM",
          "nullable": false,
          "enum_values": ["ORDER_CREATED", "ORDER_CONFIRMED", "ORDER_COMPLETED", "ORDER_CANCELLED", "PRODUCT_APPROVED", "PRODUCT_REJECTED", "PRODUCT_SOLD", "NEW_MESSAGE", "NEW_REVIEW", "PRICE_DROP", "BACK_IN_STOCK", "ACCOUNT_VERIFIED", "SECURITY_ALERT", "SYSTEM_ANNOUNCEMENT"],
          "description": "Notification category"
        },
        "action_url": {
          "type": "VARCHAR(500)",
          "nullable": true,
          "description": "URL to navigate when clicked"
        },
        "related_entity_id": {
          "type": "VARCHAR(100)",
          "nullable": true,
          "description": "ID of related entity"
        },
        "related_entity_type": {
          "type": "VARCHAR(50)",
          "nullable": true,
          "description": "Type of related entity"
        },
        "is_read": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": false,
          "description": "Read status"
        },
        "is_email_sent": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": false,
          "description": "Email notification sent"
        },
        "created_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Notification creation timestamp"
        },
        "read_at": {
          "type": "TIMESTAMP",
          "nullable": true,
          "description": "Read timestamp"
        }
      },
      "relationships": [
        {
          "type": "many_to_one",
          "target": "users",
          "foreign_key": "user_id",
          "description": "Notification for user"
        }
      ]
    },

    "product_reviews": {
      "table_name": "product_reviews",
      "description": "Reviews and ratings for products",
      "columns": {
        "id": {
          "type": "UUID",
          "nullable": false,
          "primary_key": true,
          "description": "Unique review identifier"
        },
        "reviewer_id": {
          "type": "UUID",
          "nullable": false,
          "foreign_key": "users.id",
          "description": "User who wrote review"
        },
        "product_id": {
          "type": "UUID",
          "nullable": false,
          "foreign_key": "products.id",
          "description": "Reviewed product"
        },
        "order_id": {
          "type": "UUID",
          "nullable": true,
          "foreign_key": "orders.id",
          "description": "Associated order for verification"
        },
        "rating": {
          "type": "DECIMAL(2,1)",
          "nullable": false,
          "description": "Product rating (1.0-5.0)"
        },
        "comment": {
          "type": "TEXT",
          "nullable": true,
          "description": "Review comment"
        },
        "is_verified_purchase": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": false,
          "description": "Verified purchase flag"
        },
        "is_helpful": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": false,
          "description": "Helpful review flag"
        },
        "helpful_count": {
          "type": "INTEGER",
          "nullable": false,
          "default": 0,
          "description": "Helpful votes count"
        },
        "is_reported": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": false,
          "description": "Review reported flag"
        },
        "is_approved": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": true,
          "description": "Review approval status"
        },
        "created_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Review creation timestamp"
        },
        "updated_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Last update timestamp"
        }
      },
      "constraints": [
        {
          "type": "unique",
          "columns": ["reviewer_id", "product_id"],
          "description": "One review per user per product"
        }
      ],
      "relationships": [
        {
          "type": "many_to_one",
          "target": "users",
          "foreign_key": "reviewer_id",
          "description": "Review written by user"
        },
        {
          "type": "many_to_one",
          "target": "products",
          "foreign_key": "product_id",
          "description": "Review for product"
        }
      ]
    },

    "user_reviews": {
      "table_name": "user_reviews",
      "description": "Reviews between users for transactions",
      "columns": {
        "id": {
          "type": "UUID",
          "nullable": false,
          "primary_key": true,
          "description": "Unique review identifier"
        },
        "reviewer_id": {
          "type": "UUID",
          "nullable": false,
          "foreign_key": "users.id",
          "description": "User writing the review"
        },
        "reviewee_id": {
          "type": "UUID",
          "nullable": false,
          "foreign_key": "users.id",
          "description": "User being reviewed"
        },
        "order_id": {
          "type": "UUID",
          "nullable": false,
          "foreign_key": "orders.id",
          "description": "Transaction being reviewed"
        },
        "review_type": {
          "type": "ENUM",
          "nullable": false,
          "enum_values": ["SELLER_REVIEW", "BUYER_REVIEW"],
          "description": "Type of user review"
        },
        "rating": {
          "type": "DECIMAL(2,1)",
          "nullable": false,
          "description": "Overall rating (1.0-5.0)"
        },
        "comment": {
          "type": "TEXT",
          "nullable": true,
          "description": "Review comment"
        },
        "communication_rating": {
          "type": "DECIMAL(2,1)",
          "nullable": true,
          "description": "Communication aspect rating"
        },
        "reliability_rating": {
          "type": "DECIMAL(2,1)",
          "nullable": true,
          "description": "Reliability aspect rating"
        },
        "speed_rating": {
          "type": "DECIMAL(2,1)",
          "nullable": true,
          "description": "Speed aspect rating"
        },
        "is_approved": {
          "type": "BOOLEAN",
          "nullable": false,
          "default": true,
          "description": "Review approval status"
        },
        "created_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Review creation timestamp"
        }
      },
      "constraints": [
        {
          "type": "unique",
          "columns": ["reviewer_id", "reviewee_id", "order_id"],
          "description": "One review per user pair per order"
        }
      ],
      "relationships": [
        {
          "type": "many_to_one",
          "target": "users",
          "foreign_key": "reviewer_id",
          "description": "Review written by user"
        },
        {
          "type": "many_to_one",
          "target": "users",
          "foreign_key": "reviewee_id",
          "description": "Review for user"
        },
        {
          "type": "many_to_one",
          "target": "orders",
          "foreign_key": "order_id",
          "description": "Review for order"
        }
      ]
    },

    "admin_actions": {
      "table_name": "admin_actions",
      "description": "Audit log for administrative actions",
      "columns": {
        "id": {
          "type": "UUID",
          "nullable": false,
          "primary_key": true,
          "description": "Unique action identifier"
        },
        "admin_id": {
          "type": "UUID",
          "nullable": false,
          "foreign_key": "users.id",
          "description": "Admin who performed action"
        },
        "action_type": {
          "type": "VARCHAR(50)",
          "nullable": false,
          "description": "Type of action performed"
        },
        "target_type": {
          "type": "VARCHAR(50)",
          "nullable": false,
          "description": "Type of target entity"
        },
        "target_id": {
          "type": "VARCHAR",
          "nullable": false,
          "description": "ID of target entity"
        },
        "reason": {
          "type": "TEXT",
          "nullable": true,
          "description": "Reason for action"
        },
        "details": {
          "type": "JSON",
          "nullable": true,
          "description": "Additional action details"
        },
        "ip_address": {
          "type": "VARCHAR(45)",
          "nullable": true,
          "description": "Admin's IP address"
        },
        "user_agent": {
          "type": "TEXT",
          "nullable": true,
          "description": "Admin's user agent"
        },
        "created_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Action timestamp"
        }
      },
      "relationships": [
        {
          "type": "many_to_one",
          "target": "users",
          "foreign_key": "admin_id",
          "description": "Action performed by admin"
        }
      ]
    },

    "user_sessions": {
      "table_name": "user_sessions",
      "description": "Active user login sessions tracking",
      "columns": {
        "id": {
          "type": "UUID",
          "nullable": false,
          "primary_key": true,
          "description": "Unique session identifier"
        },
        "user_id": {
          "type": "VARCHAR",
          "nullable": false,
          "description": "Associated user ID"
        },
        "refresh_token": {
          "type": "VARCHAR",
          "nullable": false,
          "description": "Session refresh token"
        },
        "ip_address": {
          "type": "VARCHAR",
          "nullable": false,
          "description": "Login IP address"
        },
        "user_agent": {
          "type": "VARCHAR",
          "nullable": true,
          "description": "Browser user agent"
        },
        "device_info": {
          "type": "VARCHAR",
          "nullable": true,
          "description": "Device information"
        },
        "created_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Session creation timestamp"
        },
        "last_used_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Last activity timestamp"
        },
        "expires_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Session expiration timestamp"
        },
        "active": {
          "type": "BOOLEAN",
          "nullable": true,
          "description": "Session active status"
        }
      }
    },

    "refresh_tokens": {
      "table_name": "refresh_tokens",
      "description": "JWT refresh token management",
      "columns": {
        "id": {
          "type": "UUID",
          "nullable": false,
          "primary_key": true,
          "description": "Unique token identifier"
        },
        "token": {
          "type": "VARCHAR",
          "nullable": false,
          "description": "Refresh token value"
        },
        "user_id": {
          "type": "VARCHAR",
          "nullable": false,
          "description": "Associated user ID"
        },
        "expires_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Token expiration timestamp"
        }
      }
    },

    "otp_tokens": {
      "table_name": "otp_tokens",
      "description": "Email verification OTP tokens",
      "columns": {
        "id": {
          "type": "UUID",
          "nullable": false,
          "primary_key": true,
          "description": "Unique OTP identifier"
        },
        "email": {
          "type": "VARCHAR",
          "nullable": false,
          "description": "Target email address"
        },
        "otp": {
          "type": "VARCHAR",
          "nullable": false,
          "description": "OTP code"
        },
        "expires_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "OTP expiration timestamp"
        }
      }
    },

    "student_otp_tokens": {
      "table_name": "student_otp_tokens",
      "description": "Student email verification OTP tokens",
      "columns": {
        "id": {
          "type": "UUID",
          "nullable": false,
          "primary_key": true,
          "description": "Unique OTP identifier"
        },
        "user_id": {
          "type": "VARCHAR",
          "nullable": false,
          "description": "User requesting verification"
        },
        "student_email": {
          "type": "VARCHAR",
          "nullable": false,
          "description": "Student email to verify"
        },
        "otp": {
          "type": "VARCHAR(6)",
          "nullable": false,
          "description": "6-digit OTP code"
        },
        "expires_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "OTP expiration timestamp"
        },
        "created_at": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "OTP creation timestamp"
        }
      }
    },

    "login_attempts": {
      "table_name": "login_attempts",
      "description": "Login attempt tracking for security",
      "columns": {
        "id": {
          "type": "UUID",
          "nullable": false,
          "primary_key": true,
          "description": "Unique attempt identifier"
        },
        "email": {
          "type": "VARCHAR",
          "nullable": false,
          "description": "Login email attempted"
        },
        "ip_address": {
          "type": "VARCHAR",
          "nullable": false,
          "description": "Attempt IP address"
        },
        "successful": {
          "type": "BOOLEAN",
          "nullable": false,
          "description": "Login success status"
        },
        "attempt_time": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Attempt timestamp"
        },
        "user_agent": {
          "type": "VARCHAR",
          "nullable": true,
          "description": "Browser user agent"
        }
      }
    },

    "security_events": {
      "table_name": "security_events",
      "description": "Security-related event logging",
      "columns": {
        "id": {
          "type": "UUID",
          "nullable": false,
          "primary_key": true,
          "description": "Unique event identifier"
        },
        "user_id": {
          "type": "VARCHAR",
          "nullable": false,
          "description": "Associated user ID"
        },
        "event_type": {
          "type": "VARCHAR",
          "nullable": false,
          "description": "Type of security event"
        },
        "ip_address": {
          "type": "VARCHAR",
          "nullable": false,
          "description": "Event IP address"
        },
        "user_agent": {
          "type": "VARCHAR",
          "nullable": true,
          "description": "Browser user agent"
        },
        "description": {
          "type": "VARCHAR",
          "nullable": true,
          "description": "Event description"
        },
        "timestamp": {
          "type": "TIMESTAMP",
          "nullable": false,
          "description": "Event timestamp"
        }
      }
    }
  },

  "enums": {
    "UserRole": ["USER", "ADMIN"],
    "SellerBadge": ["NEW_SELLER", "ACTIVE_SELLER", "TRUSTED_SELLER", "DEALHARBOR_CHOICE", "PREMIUM_SELLER", "LEGENDARY_SELLER"],
    "ProductCondition": ["NEW", "LIKE_NEW", "GOOD", "FAIR", "POOR", "USED"],
    "ProductStatus": ["PENDING", "APPROVED", "REJECTED", "SOLD", "DELETED"],
    "OrderStatus": ["PENDING", "CONFIRMED", "COMPLETED", "CANCELLED", "DISPUTED"],
    "DeliveryMethod": ["PICKUP", "DELIVERY", "SHIPPING"],
    "MessageType": ["TEXT", "IMAGE", "FILE", "SYSTEM", "ORDER_UPDATE"],
    "NotificationType": ["ORDER_CREATED", "ORDER_CONFIRMED", "ORDER_COMPLETED", "ORDER_CANCELLED", "PRODUCT_APPROVED", "PRODUCT_REJECTED", "PRODUCT_SOLD", "NEW_MESSAGE", "NEW_REVIEW", "PRICE_DROP", "BACK_IN_STOCK", "ACCOUNT_VERIFIED", "SECURITY_ALERT", "SYSTEM_ANNOUNCEMENT"],
    "ReviewType": ["SELLER_REVIEW", "BUYER_REVIEW"]
  },

  "key_relationships": [
    {
      "from": "products",
      "to": "users",
      "type": "many_to_one",
      "description": "Products are listed by sellers (users)"
    },
    {
      "from": "products",
      "to": "categories",
      "type": "many_to_one",
      "description": "Products belong to categories"
    },
    {
      "from": "orders",
      "to": "users",
      "type": "many_to_one",
      "description": "Orders involve buyers and sellers (users)"
    },
    {
      "from": "orders",
      "to": "products",
      "type": "many_to_one",
      "description": "Orders are for specific products"
    },
    {
      "from": "conversations",
      "to": "users",
      "type": "many_to_one",
      "description": "Conversations between users"
    },
    {
      "from": "messages",
      "to": "conversations",
      "type": "many_to_one",
      "description": "Messages belong to conversations"
    },
    {
      "from": "favorites",
      "to": "users",
      "type": "many_to_one",
      "description": "Users can favorite products"
    },
    {
      "from": "favorites",
      "to": "products",
      "type": "many_to_one",
      "description": "Favorites reference products"
    }
  ],

  "business_logic": {
    "student_verification": "Users can verify their student status using VIT email domains (@vitstudent.ac.in, @vit.ac.in, @vitchennai.ac.in)",
    "product_approval": "All products require admin approval before being listed publicly",
    "seller_badges": "Automatically calculated based on sales performance, ratings, and response rates",
    "price_negotiation": "Products can be marked as negotiable for flexible pricing",
    "order_workflow": "PENDING → CONFIRMED → COMPLETED (or CANCELLED at any stage)",
    "messaging_system": "Real-time messaging between buyers and sellers with order context",
    "review_system": "Dual review system for products and user transactions",
    "security_tracking": "Comprehensive logging of login attempts and security events"
  },

  "api_endpoints_summary": {
    "authentication": "/api/auth/*",
    "student_verification": "/api/student-verification/*", 
    "products": "/api/products/*",
    "categories": "/api/categories/*",
    "images": "/api/images/*",
    "test": "/api/test/*"
  }
}